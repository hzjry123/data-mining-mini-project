"0","#Lift"
"0","Curve.Lift<-function(ptest,ytest){"
"0","  df=cbind(ptest,ytest)"
"0","  rank.df=as.data.frame(df[order(ptest,decreasing=TRUE),])"
"0","  colnames(rank.df) = c('predicted','actual')"
"0","  baserate=mean(ytest)"
"0","  ## calculating the lift"
"0","  ## cumulative 1's sorted by predicted values"
"0","  ## cumulative 1's using the average success prob from evaluation set"
"0","  n.test = 100"
"0","  ax=dim(n.test)"
"0","  ay.base=dim(n.test)"
"0","  ay.pred=dim(n.test)"
"0","  ax[1]=1"
"0","  ay.base[1]=baserate"
"0","  ay.pred[1]=rank.df$actual[1]"
"0","  for (i in 2:n.test) {"
"0","    ax[i]=i"
"0","    ay.base[i]=baserate*i ## uniformly increase with rate xbar"
"0","    ay.pred[i]=ay.pred[i-1]+rank.df$actual[i]"
"0","  }"
"0","  "
"0","  df=cbind(rank.df,ay.pred,ay.base)"
"0","  plot(ax,ay.pred,xlab=""number of cases"",ylab=""number of successes"",main=""Lift: Cum successes sorted by pred val/success prob"")"
"0","  points(ax,ay.base,type=""l"")"
"0","}"
